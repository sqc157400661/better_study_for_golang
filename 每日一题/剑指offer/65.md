# 剑指 Offer 65. 不用加减乘除做加法 [简单]

## 题目描述

写一个函数，求两个整数之和，要求在函数体内不得使用` “+”、“-”、“*”、“/”` 四则运算符号。

### 示例:

```
输入: a = 1, b = 1
输出: 2
```

### 提示：

```
1、a, b 均可能是负数或 0
2、结果不会溢出 32 位整数
```

## 知识点：

| 符号 | 描述 | 运算规则                                                     |
| ---- | ---- | ------------------------------------------------------------ |
| &    | 与   | 两个位都为1时，结果才为1                                     |
| \|   | 或   | 两个位都为0时，结果才为0                                     |
| ^    | 异或 | 两个位相同为0，相异为1                                       |
| ~    | 取反 | 0变1，1变0                                                   |
| <<   | 左移 | 各二进位全部左移若干位，高位丢弃，低位补0                    |
| >>   | 右移 | 各二进位全部右移若干位，对无符号数，高位补0，有符号数，各编译器处理方法不一样，有的补符号位（算术右移），有的补0（逻辑右移 |

## 解题思路：

本题考察对位运算的灵活使用，即使用位运算实现加法。
设两数字的二进制形式 `a,b` ，其求和 `s=a+b` ，`a(i)` 代表 a 的二进制第 i 位，则分为以下四种情况：

| *a*(*i*) | *b*(*i*) | **无进位和** n(i) | **进位** c(i+1) |
| -------- | -------- | ----------------- | --------------- |
| 0        | 0        | 0                 | 0               |
| 0        | 1        | 1                 | 0               |
| 1        | 0        | 1                 | 0               |
| 1        | 1        | 0                 | 1               |

观察发现，**无进位和** 与 **异或运算** 规律相同，**进位** 和 **与运算** 规律相同（并需左移一位）。因此，无进位和 n 与进位 c的计算公式如下；

![2020.1.7jiafa](http://cdn.xiaot123.com/blog/2021-04/2020.1.7jiafa.png-blog)

`（和 s）==（非进位和 n ）+（进位 c*）`。即可将`s = a + b` 转化为：`s=a+b  ⇒  s=n+c`

循环求 n 和 c，直至进位 c = 0；此时 s = n，返回 n 即可。

![Picture1.png](http://cdn.xiaot123.com/blog/2021-04/56d56524d8d2b1318f78e209fffe0e266f97631178f6bfd627db85fcd2503205-Picture1.png-blog)


## 复杂度分析：

- 时间复杂度O(1) ： 最差情况下（例如 a= 0x7fffffff , b=1 时），需循环 32 次，使用 O(1) 时间；每轮中的常数次位操作使用 O(1) 时间。
- 空间复杂度 O(1) ： 使用常数大小的额外空间。



## 代码：

```
func add(a int, b int) int {
	c := 0
	// 进位为0时,加法计算完成,退出循环
	for b != 0 {
		c = a & b << 1 // 进位
		a = a ^ b      //非进位和  并赋值给a 进而进入下一次循环使用
		b = c // 进位赋值给b,进而进入下一次循环使用
	}
	return a
}
```

