# 剑指 Offer 47. 礼物的最大价值

## 题目描述

在一个 `m*n` 的棋盘的每一格都放有一个礼物，每个礼物都有一定的价值（价值大于 0）。你可以从棋盘的左上角开始拿格子里的礼物，并每次向右或者向下移动一格、直到到达棋盘的右下角。给定一个棋盘及其上面的礼物的价值，请计算你最多能拿到多少价值的礼物？

 

### 示例:

```
输入: 
[
  [1,3,1],
  [1,5,1],
  [4,2,1]
]
输出: 12
解释: 路径 1→3→5→2→1 可以拿到最多价值的礼物
```

### 限制：

```
0 < grid.length <= 200
0 < grid[0].length <= 200
```

## 解题思路：

题目说明：

从棋盘的左上角开始拿格子里的礼物，并每次 **向右** 或者 **向下** 移动一格、直到到达棋盘的右下角。

根据题目说明，易得某单元格只可能从上边单元格或左边单元格到达。

设 `f(i, j)` 为从棋盘左上角走至单元格 `(i,j)` 的礼物最大累计价值，易得到以下递推关系：`f(i,j)` 等于 `f(i,j−1)` 和 `f(i−1,j)` 中的较大值加上当前单元格礼物价值`grid(i,j)` 。

`f(i,j)=max[f(i,j−1),f(i−1,j)]+grid(i,j)`

因此，可用动态规划解决此问题，以上公式便为转移方程。

![Picture1.png](D:\www\better_study_for_golang\每日一题\images\73153e75d74b1f48ac47244681caacc8ad20ca2ffd2dee2f70a2768dee09d073-Picture1.png)

动态规划解析：

- **状态定义**： 设动态规划矩阵 dp ，`dp(i,j)` 代表从棋盘的左上角开始，到达单元格 `(i,j)` 时能拿到礼物的最大累计价值。

- **转移方程**：

  - 当i=0 且j=0 时，为起始元素；
  - 当i=0 且 j !=0 时，为矩阵第一行元素，只可从左边到达；
  - 当 i !=0 且j=0 时，为矩阵第一列元素，只可从上边到达；
  - 当 i !=0 且 j !=0 时，可从左边或上边到达；
  - 

  ![1616640354705](D:\www\better_study_for_golang\每日一题\images\1616640354705.png)

- 初始状态： `dp[0][0]=grid[0][0]` ，即到达单元格`(0,0)` 时能拿到礼物的最大累计价值为 `grid[0][0]` ；

- 返回值： `dp[m−1][n−1]`，m,n 分别为矩阵的行高和列宽，即返回 dp 矩阵右下角元素。

空间复杂度优化：

- 由于 `dp[i][j]` 只与 `dp[i−1][j]` , `dp[i][j−1]` , `grid[i][j]` 有关系，因此可以将原矩阵 grid 用作 dp 矩阵，即直接在 grid 上修改即可。
- 应用此方法可省去 dp 矩阵使用的额外空间，因此空间复杂度从 O(MN) 降至O(1) 。

(1)

![img](D:\www\better_study_for_golang\每日一题\images\67cf85128a890bac4a7e38062f728ce536ebecd6c3595dd99e94f7f4cb2edd9f-Picture2.png)

(2)

![img](D:\www\better_study_for_golang\每日一题\images\f74a7d8a2b3d6151c3ffad67091ccb6e7360301d7d2e2b4d57c1f8cbdd4d439c-Picture3.png)

(3)

![img](D:\www\better_study_for_golang\每日一题\images\df35c99048191872eabf260600a7f8ca33e11b71374a1245c9924a5012788e7a-Picture5.png)

(4)

![img](D:\www\better_study_for_golang\每日一题\images\68914728aa4e45427315b07f2711970c2917dbac03d78721a4e898ac360b56ca-Picture6.png)

(5)

![img](D:\www\better_study_for_golang\每日一题\images\7d62208403a02b8439fecec0e37b3910e47dfe3a0280af7d9f438e0a992005f3-Picture10.png)

(6)

![img](D:\www\better_study_for_golang\每日一题\images\d7005f30bf7bfc9e41860fa186e8f03c2481256323f3d66bfbf0852f08f5e57b-Picture11.png)

## 复杂度分析：

- 时间复杂度 O(MN) ： M,N 分别为矩阵行高、列宽；动态规划需遍历整个grid 矩阵，使用 O(MN) 时间。
- 空间复杂度 O(1) ： 原地修改使用常数大小的额外空间。



## 代码：

```

```

